<!doctype html>
<html lang="en">
  <head>
    <title>CSCI 3308 Homework 3</title>

    <!-- Bootstrap core CSS & JS -->
    <link rel="stylesheet" type="text/css" href="../resources/css/bootstrap.css">
    <link rel="stylesheet" type="text/css" href="../resources/css/prism.css">
    <script src="../resources/js/jquery-3.3.1.js"></script>
    <script src="../resources/js/popper.js"></script>
    <script src="../resources/js/bootstrap.js"></script>
    <script src="../resources/js/clipboard.js"></script>
    <script src="../resources/js/prism.js"></script>
    <!-- Custom CSS -->

    <link rel="stylesheet" type="text/css" href="../resources/css/labLayout.css">
    <link rel="stylesheet" type="text/css" href="../resources/css/login.css">
    <script type="text/javascript" src="../resources/js/login.js"></script>
    <script src="../resources/js/labScripts.js"></script>
  </head>
  <body onload="loadPage()">

    <main role="main" class="container">
      <div class="container-fluid">
        <div class="row">
          <div class="col-10">
            <h1 class="display-4">Homework 3: SQL</h1>
            <p class="lead">Due date: 15th November, 11:59 p.m.</p>
          </div>
        </div>
      </div>
      <div class="card card-body" id="step1">
        <div class="stepLine">
          <p class="alignleft h5">Overview</p>
          <button class="btn btn-primary btn-sm alignbtn" type="button" data-toggle="collapse"
          data-target="#multiCollapseExample1" aria-expanded="false"
          aria-controls="multiCollapseExample1">Expand</button>
      </div>
      <div class="collapse" id="multiCollapseExample1" style="padding-top:30px;">
        <ol>
          <li>Start a postgresql instance and run the script northwind.sql.</li>
          <li>Once the data is loaded, write the queries to answer the questions below.</li>
          <li>Turn in a file with the QUERY and the RESULT for each question. We have included an example .txt file with a format for your submission; feel free to use this or your own version, but remember to include both query and result!</li>
        </ol>
          <br />
          <h6><a href="./image.png" target="_blank">Here</a> is a data model for the database for your reference</h6>
        </div>
      </div>
      <div class="card card-body" id="step2">
        <div class="stepLine">
          <p class="alignleft h5">Step 1: Initializing your database</p>
          <button class="btn btn-primary btn-sm alignbtn" type="button" data-toggle="collapse"
          data-target="#multiCollapseExample2" aria-expanded="false"
          aria-controls="multiCollapseExample2">Expand</button>
        </div>
        <div class="collapse" id="multiCollapseExample2" style="padding-top:30px;">
          <div class="alert alert-primary">
            <h6>Download the files needed for this homework from
            <a href="./homework3.zip">here</a></h6>
          </div>
          <ol>
            <li>Start your postgres instance<br>
            <pre class="command-line" data-user="csci3308" data-host="csci3308-VirtualBox"><code  class="language-bash">sudo -u postgres psql</code></pre>
          </li>
            <li>Run the northwind.sql script to import data <br>
            <pre class="command-line" data-prompt="postgres=#"><code  class="language-bash">\i &lt;path_to_northwind.sql&gt;;</code></pre>
            For eg: <br>
            <pre class="command-line" data-prompt="postgres=#"><code  class="language-bash">\i Downloads/northwind.sql;</code></pre>
          </li>
          </ol>
        </div>
      </div>
      <div class="card card-body" id="step3">
        <div class="stepLine">
          <p class="alignleft h5">Part 2: Create and Execute queries (100 points)</p>
          <button class="btn btn-primary btn-sm alignbtn" type="button" data-toggle="collapse"
          data-target="#multiCollapseExample3" aria-expanded="false"
          aria-controls="multiCollapseExample3">Expand</button>
        </div>
        <div class="collapse" id="multiCollapseExample3" style="padding-top:30px;">
          <div class="alert alert-primary">
            <p>You must create and execute queries against the northwinds database to fulfill the requirements of this assignments. For each question, you must submit your query AND the result of the query. Each question has an associated number of rows that you should expect in resulting query.</p>
          </div>
          <div class="">
            <table>
              <tr>
                <th>Serial No</th>
                <th>Query</th>
                <th>Number of rows returned</th>
                <th>points</th>
              </tr>
              <tr>
                <td>1</td>
                <td>Create an alphabetical listing (last name, first name) of all employees not living the in the
UK who have been employed by Northwinds for at least 5 years as of the due date of this assignment (2019-04-14).</td>
                <td>5 rows</td>
                <td>4</td>
              </tr>
              <tr>
                <td>2</td>
                <td>Prepare a reorder list for products that currently have at least one unit in stock but are (strictly) below their reorder level. Display the product ID, name, quantity in stock, and unit price for each matching product.</td>
                <td>17 rows</td>
                <td>4</td>
              </tr>
              <tr>
                <td>3</td>
                <td>What is the name and unit price of the least expensive product sold by Northwinds? Use a subquery.</td>
                <td>1 row</td>
                <td>4</td>
              </tr>
              <tr>
                <td>4</td>
                <td>Create a list of the products in stock which have an inventory value (number of units in stock * unit price) under $200. Display the product ID, product name, and “total inventory value” in ascending total inventory value order (lowest to highest).</td>
                <td>15 rows</td>
                <td>4</td>
              </tr>
              <tr>
                <td>5</td>
                <td>List the country and a count of orders for all orders that shipped from that country for all countries other than the USA during August 1996.</td>
                <td>10 rows</td>
                <td>6</td>
              </tr>
              <tr>
                <td>6</td>
                <td>List the customer ID of the customers who have less than 4 orders in descending alphabetical order (Z-A).</td>
                <td>10 rows</td>
                <td>4</td>
              </tr>
              <tr>
                <td>7</td>
                <td>Create a supplier inventory report that shows the total value of each suppliers inventory in stock (total value = sum over all units of (units in stock * unit price)). List only those suppliers who supply more than 3 different items.</td>
                <td>4 rows</td>
                <td>4</td>
              </tr>
              <tr>
                <td>8</td>
                <td>Create a supplier price list showing the supplier company name, product name, and unit price for all products from suppliers located in France. Sort the list on unit price in descending order (highest to lowest). <br> <i>hint: must use both the products table and the suppliers table</i></td>
                <td>5 rows</td>
                <td>6</td>
              </tr>
              <tr>
                <td>9</td>
                <td>Create an employee order list showing the last name, first name, title, extension, and number of orders for each employee who has less than 75 orders. <br><i>Hint: must use both the employees table and the orders table</i></td>
                <td>5 rows</td>
                <td>6</td>
              </tr>
              <tr>
                <td>10</td>
                <td>Create a NEW table named top_items with the following items: item_id (integer), item_code (integer), item_name (varchar(40)), inventory_date (DATE), supplier_id (integer), item_quantity (integer), and item_price (decimal (9,2)). None of these columns can be null. Include a PRIMARY KEY constraint on item_id. </td>
                <td>No answer set needed, just the create table command</td>
                <td>6</td>
              </tr>
              <tr>
                <td>11</td>
                <td>Populate the new table top_items with items from products for those products whose inventory value is greater than $2500. The corresponding columns are the following:<br>
                  a. product_id -> item_id
                  <br>b. category_id -> item_code
                  <br>c. product_name -> item_name
                  <br>d. <today’s date> -> inventory_date
                  <br>e. units_in_stock -> item_quantity
                  <br>f. unit_price -> item_price
                  <br>g. supplier_id -> supplier_id
                  <br><i>Hint: this entails an INSERT with a SELECT query as the insert value. </i><br>
                (No answer set needed, just the populate command)</td>
                <td>9 rows inserted</td>
                <td>6</td>
              </tr>
              <tr>
                <td>12</td>
                <td>Delete the rows in top_items for items with item_quantity less than 50. <br>
                (No answer set deleted, just the delete command)</td>
                <td>4 rows deleted</td>
                <td>4</td>
              </tr>
              <tr>
                <td>13</td>
                <td>Add a new column to the top_items table called inventory_value (decimal (9,2)), with a default value of 0.</td>
                <td>No answer set needed, just the column add command</td>
                <td>4</td>
              </tr>
              <tr>
                <td>14</td>
                <td>Update the top_items table, setting the inventory_value column equal to item_price * item_quantity.</td>
                <td>No answer set needed, just the update command</td>
                <td>4</td>
              </tr>
              <tr>
                <td>15</td>
                <td>Drop the top_items table.</td>
                <td>No answer set table, just the drop command</td>
                <td>4</td>
              </tr>
              <tr>
                <td>16</td>
                <td>Create a list of employees' first and last names as well as the number of unique customers they have sold to called "clients". Only include employees who have sold to at least 50 unique clients. Display results in descending order by number of clients.</td>
                <td>5 rows</td>
                <td>6</td>
              </tr>
              <tr>
                <td>17</td>
                <td>Find all products that are cost less than the average unit price</td>
                <td>52 rows</td>
                <td>4</td>
              </tr>
              <tr>
                <td>18</td>
                <td>You’re Jeff Bezos and your employees have access to free Prime subscription. You’ve heard rumors that your employees are letting their neighbors and relatives use Prime. Find count of all employees that’ve ordered products to a different address (not their home address) in their city. </td>
                <td>1 row</td>
                <td>6</td>
              </tr>
              <tr>
                <td>19</td>
                <td>Create a list of employees and the number of orders they have completed and the number of unique clients sold to during the calendar year of 1998. Your table should display each employee's first and last name, the number of unique clients, and the number of orders as order_count.</td>
                <td>9 rows</td>
                <td>6</td>
              </tr>
              <tr>
                <td>20</td>
                <td>‘Janet Leverling’ wants to know the count of all the orders which were getting shipped from ‘Sweden’ and took less than a week time to ship.</td>
                <td>1 row</td>
                <td>4</td>
              </tr>
              <tr>
                <td>21</td>
                <td>The company ‘Leka Trading’ was blacklisted by the regulators. List out all the product which were being supplied from this supplier.</td>
                <td>3 rows</td>
                <td>4</td>
              </tr>
            </table>
          </div>
        </div>
      </div>
      <div class="card card-body" id="step5">
        <div class="stepLine">
          <p class="alignleft h5">Bonus Question (10 points)</p>
          <button class="btn btn-primary btn-sm alignbtn" type="button" data-toggle="collapse"
          data-target="#multiCollapseExample5" aria-expanded="false"
          aria-controls="multiCollapseExample5">Expand</button>
        </div>
        <div class="collapse" id="multiCollapseExample5" style="padding-top:30px;">
          <table>
            <tr>
              <th>Serial No</th>
              <th>Query</th>
              <th>Number of rows returned</th>
              <th>points</th>
            </tr>
            <tr>
              <td>1</td>
              <td>Create a list of employee names, the number of orders they have completed, and the number of clients sold to during the calendar year of 1998. Only include employees that have either (a) more than 50 clients or (b) more than 70 orders. Your table should display each employee's first and last name, the number of unique clients, and the number of orders as order_count.</td>
              <td>6 rows</td>
              <td>6</td>
            </tr>
            <tr>
              <td>2</td>
              <td>Find the average price of products that are supplied by companies that are based in the United States. Specify the name of company alongside  the average price.</td>
              <td>4 rows</td>
              <td>4</td>
            </tr>
          </table>
        </div>
      </div>
<div class="card card-body" id="step6">
  <div class="stepLine">
    <p class="alignleft h5">Submission Criteria</p>
    <button class="btn btn-primary btn-sm alignbtn" type="button" data-toggle="collapse"
    data-target="#multiCollapseExample6" aria-expanded="false"
    aria-controls="multiCollapseExample6">Expand</button>
  </div>
  <div class="collapse" id="multiCollapseExample6" style="padding-top:30px;">
    <dt></dt>
    <dd>
        - Name your file Homework3_[YourName] and submit it on Canvas. <br>
        - Turn in a file with the QUERY and the RESULT for each question. <br>
        - We have included an example.txt file, in the zip file, with a format for your submission; feel free to use this or your own version, <b> but remember to include both query and result! </b>
        </dd>
  </div>
</div>
<div class="card card-body" id="step7">
  <div class="stepLine">
    <p class="alignleft h5">Rubric</p>
    <button class="btn btn-primary btn-sm alignbtn" type="button" data-toggle="collapse"
    data-target="#multiCollapseExample7" aria-expanded="false"
    aria-controls="multiCollapseExample7">Expand</button>
  </div>
  <div class="collapse" id="multiCollapseExample7" style="padding-top:30px;">
    <dd>
      <p>- Points are defined in against each query.</p>
    </dd>
  </div>
</div>
</main><!-- /.container -->
<div id="bottom_nav">
  <div class="row">
    <div class="col-10">
    </div>
    <div class="col-2">
      <div class="row">
        <div class="col-2">
        </div>
        <div class="col-10">
          <div class="card">
            <div class="card-body">
              <p class="h4 text-center">Helper Icons</p>
              <hr>
              <div class="row">
                <div class="col-4">
                  <img src="../resources/img/octicons/alert.svg" alt="Octicon alert icon" style="padding-right:15px"
                  height="30px">
                </div>
                <div class="col-8">Common Errors</div>
              </div>
              <div class="row">
                <div class="col-4">
                  <img src="../resources/img/octicons/info.svg" alt="Octicon info icon" style="padding-right:15px"
                  height="30px">
                </div>
                <div class="col-8">More Information</div>
              </div>
            </div>
          </div>
          <button class="btn btn-primary btn-block alignright expandAll" type="button">Expand All</button>
          <button class="btn btn-primary btn-block alignright collapseAll" type="button">Collapse All</button>
        </div>
      </div>
    </div>
  </div>
</div>
</body>
</html>
